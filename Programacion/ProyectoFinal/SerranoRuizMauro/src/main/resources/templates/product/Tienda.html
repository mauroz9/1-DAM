<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Tienda de Tabla Rota Skate Shop">
	<title>Tienda - Tabla Rota Skate Shop</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<link rel="stylesheet" type="text/css" th:href="@{/css/HojaDeEstilo.css}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

</head>

<body>
	<header th:replace="~{Fragments :: header}"></header>

	<main>
		<section class="container my-4">
			<div class="row align-items-center">
				<div class="col-md-6">
					<div class="mb-4">
						<h2 class="fw-bold border-bottom pb-2">TABLA ROTA - SKATESHOP</h2>
						<p class="text-muted">EL MEJOR MATERIAL</p>
						<p>¿Estás buscando un nuevo skate o necesitas una nueva tabla o ruedas? En Tabla Rota Skate Shop
							encontrarás todo lo que necesitas para patinar. Tanto si eres principiante como pro, tenemos
							las mejores marcas y mucha información para
							ayudarte en el camino.</p>
					</div>
				</div>

				<div class="col-md-6">
					<img src="https://images.pexels.com/photos/5880093/pexels-photo-5880093.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"
						class="img-fluid rounded" alt="Tienda de skate">
				</div>
			</div>

			<div class="row justify-content-center mt-5 g-2" th:if="${categories}">
				<div class="col-4 col-lg-1 text-center" th:each="category : ${categories}">
					<a th:if="${selectedCategoryId != category.id}" th:href="@{'/shop/' + ${category.id}}">
						<button class="btn btn-outline-dark rounded-circle p-4 border-2">

						</button>
					</a>
					<a th:if="${selectedCategoryId == category.id}" th:href="@{'/shop'}">
						<button class="btn btn-dark rounded-circle p-4 border-2">

						</button>
					</a>
					<p class="d-block mt-2" th:text="${category.categoryName}">Nombre de la categoría</p>
				</div>

			</div>
		</section>

		<section class="container my-4">
			<div class="mb-4">
				<div class="row align-items-center">
					<div class="col-12 col-md-6 mb-3 mb-md-0">
						<h1 class="fw-bold text-center text-md-start" th:text="${resultCount} + ' RESULTADOS'">0
							RESULTADOS</h1>
					</div>

					<div class="col-12 col-md-6">
						<div class="row g-2">
							<div class="col-12 col-sm-7">
								<form class="d-flex" th:action="@{/shop/search}" method="get">
									<input class="form-control me-2" type="search" name="search" placeholder="Buscar">
									<button class="btn btn-outline-dark" type="submit">
										<i class="bi bi-search"></i>
									</button>
								</form>
							</div>
							<div class="col-12 col-sm-5">
								<form action="#" method="get">
									<select class="form-select w-100" name="sort" onchange="this.form.submit()"
										aria-label="Ordenar productos">
										<option value="" th:selected="${sort == null}">Ordenar</option>
										<option value="0" th:selected="${sort == 0}">Precio: Menor a mayor</option>
										<option value="1" th:selected="${sort == 1}">Precio: Mayor a menor</option>
										<option value="2" th:selected="${sort == 2}">Nombre: A-Z</option>
										<option value="3" th:selected="${sort == 3}">Nombre: Z-A</option>
										<option value="4" th:selected="${sort == 4}">Más recientes</option>
									</select>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>


			<div class="row m-4 text-center">
				<div class="col-6">
					<a href="/create-product" class="btn btn-dark btn-lg">
						<i class="bi bi-plus-lg"></i> Añadir nuevo producto
					</a>
				</div>
				<div class="col-6">
					<a href="/shop/hidden-products" class="btn btn-dark btn-lg">
						<i class="bi bi-eye"></i> Ver productos ocultos
					</a>
				</div>
			</div>

			<div class="row mt-5" th:if="${products}">
				<div class="col-lg-4 col-md-6 col-sm-12 mb-5" th:each="product : ${products}">
					<div class="card h-100 shadow">
						<img th:src="${#strings.isEmpty(product.image) ? 'https://www.shutterstock.com/image-vector/image-icon-trendy-flat-style-600nw-643080895.jpg' : product.image}"
							th:alt="${#strings.isEmpty(product.altText) ? 'Imagen por defecto' : product.altText}"
							class="card-img-top" />
						<div class="card-body d-flex flex-column">
							<h5 class="card-title" th:text="${product.name}">Nombre del producto</h5>
							<p class="card-text" th:text="${product.description}">Descripción del producto</p>
							<div>
								<h5 class="card-text"
									th:if="${product.getFinalDiscount == null or product.getFinalDiscount == 0}"
									th:text="${#numbers.formatDecimal(product.price, 1, 2) + '€'}">
									Precio del producto
								</h5>

								<h5 class="card-text"
									th:if="${product.getFinalDiscount != null and product.getFinalDiscount > 0}">

									<span class="text-danger"
										th:text="${#numbers.formatDecimal(product.getDiscountedPrice, 1, 2) + '€'}">
									</span>

									<span class="text-decoration-line-through ms-2"
										th:text="${#numbers.formatDecimal(product.price, 1, 2) + ' €'}">
									</span>

									<span class="text-danger"
										th:text="${'-' + #numbers.formatDecimal(product.getFinalDiscount, 1, 0) + '%'}">
									</span>
								</h5>
							</div>

							<div class="d-flex justify-content-end">
								<a th:href="@{'/shop/product/' + ${product.id}}" class="btn btn-sm btn-outline-dark">
									<i class="bi bi-arrow-bar-left p-1"></i>Ver más</a>
							</div>

							<div class="mt-3 d-flex justify-content-between">
								<a th:href="@{'/modify-product/' + ${product.id}}" class="btn btn-outline-dark btn-sm">
									<i class="bi bi-pencil"></i> Modificar
								</a>
								<button type="button" class="btn btn-outline-danger btn-sm" data-bs-toggle="modal"
									th:data-bs-target="'#deleteModal' + ${product.id}">
									<i class="bi bi-x"></i> Eliminar
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<div th:replace="~{Fragments :: productDeleteModal}"></div>

	</main>

	<footer class="mt-5 border-top" th:replace="~{Fragments :: footer}"></footer>

</body>

</html>